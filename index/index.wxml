<wxs module="utils">
module.exports.max = function(n1, n2) {
  return Math.max(n1, n2)
}
module.exports.len = function(arr) {
  arr = arr || []
  return arr.length
}
</wxs>
<view class="container">
  <!-- <view class="header">
    <text class="title">设备连接</text>
  </view> -->

  <view class="content">
    <view class="search-area">
      <button class="search-button" bindtap="openBluetoothAdapter">搜索设备</button>
    </view>

    <view class="device-area" wx:if="{{miniArmDevice}}">
      <view class="device-card" bindtap="createBLEConnection" data-device-id="{{miniArmDevice.deviceId}}" data-name="{{miniArmDevice.name || miniArmDevice.localName}}">
        <view class="device-icon">
          <image src="/path/to/mini-arm-icon.png" mode="aspectFit"></image>
        </view>
        <view class="device-info">
          <text class="device-name">{{miniArmDevice.name || miniArmDevice.localName}}</text>
          <text class="device-signal">信号强度: {{miniArmDevice.RSSI}}dBm({{utils.max(0, miniArmDevice.RSSI + 100)}}%)</text>
          <text class="device-signal">UUID: {{miniArmDevice.deviceId}}</text>
        </view>
        <view class="connect-icon">
          <text class="iconfont icon-right"></text>
        </view>
      </view>
    </view>

    <view class="no-device" wx:else>
      <text>未找到 mini-arm 设备</text>
      <text>请确保设备已开启并在范围内</text>
    </view>
  </view>

  <!-- <view class="footer">
    <button class="action-button" bindtap="stopBluetoothDevicesDiscovery">停止搜索</button>
    <button class="action-button" bindtap="closeBluetoothAdapter">重启服务</button>
  </view> -->
</view>